# Домашнее задание по курсу "Administrator Linux. Professional"

**Название задания:** 

  - Собрать RAID-массив. 

**Текст задания:** 

  - Создать виртуальную машину с пятью подключенными дисками через Vagrantfile. 
  - Собрать RAID-10.
  - Прописать собранный RAID-10 в конфигурационный файл, чтобы RAID-10 собирался при запуске.
  - Создать GPT-раздел и 5 партиций на собранном RAID и смонтировать их на диск.
  - Прописать результат монтирования в ```/etc/fstab```, чтобы монтирование происходило при запуске.
  - Сломать/починить RAID

**Результаты работы:** 

  - Все необходимые для сборки файлы находятся в директории ```./centos7```. 
  - ```Vagrantfile```: инициализация виртуальной машины с ОС centos7, \
    добавление в нее 5 дисков по 1 ГБ, создание RAID-10 из 4-х дисков и GPT-раздела с 5 партициями, \
    запись созданного RAID и файловой системы в конфигурационные файлы, \
    копирование скриптов для проверки и для поломки/починки RAID-а на виртуалку.
  - ```script.sh```: скрипт, который запускается при создании виртуалки через Vagrantfile.
  - ```check.sh```: скрипт для проверки существования и работы RAID и файловой системы на нём, \
    нужно его запустить из директории ```/home/vagrant/``` на виртуалке.
  - ```rebuild.sh```: фейлит один из дисков в RAID-массиве, заменяет его на чистый \
    и восстанавливает RAID. Его тоже нужно запустить из директории ```/home/vagrant/``` на виртуалке.

## 1. Листинг команд:
   
 - Скачиваем директорию  ```./centos7``` и заходим в неё.
 - Выполняем команду
 
```
vagrant up
```
   для создания виртуалки. При этом создастся RAID-10 из 4-х дисков, \
   на созданном RAID создастся GPT-раздел с 5-ю партициями, \
   которые смонтируются в ```/home/vagrant/raid/part{1..5}```. \
   Полученные изменения будут прописаны в конфиги. Для centos7 это будут файлы \
   ```/etc/mdadm.conf``` для хранения информации о RAID-массиве и ```/etc/fstab``` \
   для хранения информации о смонтированной файловой системе. Далее будут \
   скопированы остальные скрипты в ```/home/vagrant```.
 - Можно перезагрузить виртуалку, чтобы убедиться, что изменения сохранятся. \
   Сразу же заходим в неё:
   
```
vagrant halt    
vagrant up
vagrant ssh
```
 - Мы попадём в директорию ```/home/vagrant```. Затем нужно выполнить 
   
```
./check.sh
```
   для вывода информации о RAID-массиве и смонтированной \
   файловой системе, а также для создания файла ```/home/vagrant/raid/part1/file.txt```, \
   чтобы убедиться, что мы можем записывать и читать информацию из полученной \
   файловой системы.
 - Выполняем

```
./rebuild.sh
```
   
   для вывода из строя одного из дисков RAID-массива \
   и замены его на ранее не использовавшийся диск. \
   Можно еще несколько раз запустить 

```
sudo mdadm -D /dev/md0
```

   чтобы увидеть процесс восстановления RAID-массива.
 - Выполняем
 
 ```
 ./check.sh
```
   
   чтобы убедиться, что RAID на месте, файловая система смонтирована, \
   а также записать еще одну строку в тестовый файл \
   ```/home/vagrant/raid/part1/file.txt``` и вывести его содержимое за экран.
 - Выполняем
   
```
exit
vagrant destroy -f
```
  для окончания работы и разрушения виртуальной машины.

## 2. Вопросы после выполнения домашнего задания:
   
 - Откуда мы знаем, что после выполнения
 
```
sudo parted /dev/md0 mkpart primary xfs 0% 20%
sudo parted /dev/md0 mkpart primary xfs 20% 40%
sudo parted /dev/md0 mkpart primary xfs 40% 60%
sudo parted /dev/md0 mkpart primary xfs 60% 80%
sudo parted /dev/md0 mkpart primary xfs 80% 100%
```
   полученные партиции будут иметь названия ```/dev/md0p{1..5}``` ?
   
- При создании VM через Vagrant получаю следующую ошибку:
  
